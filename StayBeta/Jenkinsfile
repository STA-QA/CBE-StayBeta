node {
stage ('Git Checkout'){
git "https://github.com/Kiranmaiadams/CBE-Automation"
}
stage ('Build Project'){
bat "mvn -f StayBeta/pom.xml clean"
}
 stage ('Run Test'){
bat "mvn -f StayBeta/pom.xml test"
}

stage ('Publish Report'){
publishHTML([allowMissing: false, alwaysLinkToLastBuild: true, keepAll: true, reportDir: 'StayBeta/Reports/', reportFiles: '1SourceReleaseReport.html', reportName: '1SourceReleaseReport', reportTitles: ''])
}
 stage('Email Notification') 
 {
                   //  bat "del reportsAut.zip"
               zip zipFile: 'reportsAut.zip', archive: false, dir: 'StayBeta/Reports'
               emailext attachmentsPattern: 'reportsAut.zip', body: '''${SCRIPT, template="groovy-html.template"}''', 
                    subject: "${env.JOB_NAME} - Build # ${env.BUILD_NUMBER} - Successful", 
                    mimeType: 'text/html',to: "kiranmai.adams@statravel.com"
            
        }
    }
   